<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Database  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="Database  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Database Docs</a> (33% documented)</p>
        <p class="header-right"><a href="https://github.com/gnosis/safe-ios"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Database Reference</a>
        <img id="carat" src="img/carat.png" />
        Database  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/CSQLite3.html">CSQLite3</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/FunctionCallTrace.html">FunctionCallTrace</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MockConnection.html">MockConnection</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MockDatabase.html">MockDatabase</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MockResultSet.html">MockResultSet</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MockStatement.html">MockStatement</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SQLiteConnection.html">SQLiteConnection</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SQLiteDatabase.html">SQLiteDatabase</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SQLiteDatabase/Error.html">– Error</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SQLiteResultSet.html">SQLiteResultSet</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SQLiteStatement.html">SQLiteStatement</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Connection.html">Connection</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Database.html">Database</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ResultSet.html">ResultSet</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols.html#/s:8Database11SQLBindableP">SQLBindable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Statement.html">Statement</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:8Database16MockRawResultSeta">MockRawResultSet</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='database-module' class='heading'>Database module</h1>

<p>The Database module defines protocols for a simple database access, inspired by standard JDBC interfaces and Enterprise Development Patterns book.</p>

<p>The module also provides SQLite implementation of the given protocols, so this module requires its clinets to link with <code>sqlite3</code> library.</p>

<p>Most of the time, you can use <code><a href="Protocols/Database.html#/s:8DatabaseAAP7executeySS3sql_SayAA11SQLBindable_pSgG8bindingss10DictionaryVySSAFG4dicttKF">Database.execute(sql:bindings:dict:)</a></code> and <code><a href="Protocols/Database.html#/s:8DatabaseAAP7executeSayqd__SgGSS3sql_SayAA11SQLBindable_pSgG8bindingss10DictionaryVySSAHG4dictAdA9ResultSet_pKc9resultMaptKlF">Database.execute(sql:bindings:dict:resultMap:)</a></code> methods to directly execute SQL requests and avoid dealing with connections, statements and result sets. For more precise control, those objects are available.</p>

<p>All of the protocols are supposed to work in concert. <code><a href="Protocols/Database.html">Database</a></code> can be created and destroyed, it can create <code><a href="Protocols/Connection.html">Connection</a></code>s and close them. Each <code><a href="Protocols/Connection.html">Connection</a></code> can prepare <code><a href="Protocols/Statement.html">Statement</a></code>s from SQL command.</p>

<p><code><a href="Protocols/Statement.html">Statement</a></code> can bind values of types <code>String</code>, <code>Data</code>, <code>Int</code>, <code>Double</code> or <code>nil</code> by index (starting at 1), or by key. Of course, a <code><a href="Protocols/Statement.html">Statement</a></code> can be executed. If <code><a href="Protocols/Statement.html">Statement</a></code> returns result, then <code><a href="Protocols/ResultSet.html">ResultSet</a></code> returned from <code><a href="Protocols/Statement.html#/s:8Database9StatementP7executeAA9ResultSet_pSgyKF">Statement.execute()</a></code> method.</p>

<p><code><a href="Protocols/ResultSet.html">ResultSet</a></code> represents a cursor of the current row of the result of a <code><a href="Protocols/Statement.html">Statement</a></code> execution. It can move to the next row, and extract value by 0-based column index.</p>

<p>For unit testing, the module contains <code><a href="Classes/MockDatabase.html">MockDatabase</a></code>&lsquo;s mock implementations.</p>
<h2 id='sqlite-implementation' class='heading'>SQLite implementation</h2>

<p>The module wraps C sqlite3 APIs in one class, <code>CSQlite3</code>, which is mocked by <code>MockCSQlite3</code>, to allow for unit testing of different cases, such as error codes, different results of execution and so on. </p>

<p>The main class to work with is <code><a href="Classes/SQLiteDatabase.html">SQLiteDatabase</a></code>, which implements <code><a href="Protocols/Database.html">Database</a></code> interface using underlying <code><a href="Classes/CSQLite3.html">CSQLite3</a></code> methods and <code>Foundation.FileManager</code>.</p>

<p>To create a database, initialize it and call <code><a href="Protocols/Database.html#/s:8DatabaseAAP6createyyKF">Database.create()</a></code> method. After that, you can start executing SQL queries and updates.</p>

<p>NOTE: currently, only one SQL command per execution is supported. Support for multiple, semicolon-separated SQL commands in one <code><a href="Protocols/Database.html#/s:8DatabaseAAP7executeySS3sql_SayAA11SQLBindable_pSgG8bindingss10DictionaryVySSAFG4dicttKF">Database.execute(...)</a></code> call will be added in future version.</p>

<p>The SQLite database will work in multi-threaded mode, that means you can safely use the database from different threads, and it will work. </p>

<p>The default behavior when multiple threads are accesssing the database is that there can be only one write access to SQLite at a time, all other threads must wait when write operation finishes. </p>

<p>There could be multiple simultaneous reads. In case a thread must wait for other thread to finish, the database method call will block (wait) until it can be resumed.</p>

          </section>
        </section>
        <section id="footer">
          <p>Copyright © 2018 Gnosis Ltd. All rights reserved.</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.3</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
